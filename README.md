# Step 2: Docker Composeを使う

## 🎯 このステップの目標

Docker Composeを使って、フロントエンドとバックエンドを同時に管理しましょう！

## 📝 課題

### 課題1: `docker-compose.yml` を作成してください

プロジェクトルートに `docker-compose.yml` を作成してください：

```yaml
version: '3.8'

services:
  # フロントエンド (React)
  frontend:
    # ヒント: build: ./frontend
    # ヒント: ports: - "3000:3000"
    # ヒント: environment: - REACT_APP_API_URL=http://localhost:8000
    # ヒント: depends_on: - backend

  # バックエンド (Node.js + Express)  
  backend:
    # ヒント: build: ./backend
    # ヒント: ports: - "8000:8000"
```

### 🔗 コンテナ間の依存関係とは？

**`depends_on` の重要性:**

```yaml
frontend:
  depends_on:
    - backend  # フロントエンドはバックエンドに依存
```

**`depends_on` がある場合:**
1. バックエンドが先に起動
2. バックエンドの起動完了後、フロントエンドが起動
3. フロントエンドがAPIにアクセスできる

**`depends_on` がない場合:**
1. コンテナが同時に起動開始
2. フロントエンドが先に起動する可能性
3. バックエンドがまだ起動中のAPIアクセスでエラー発生

**実際の動作例:**
```
⚠️ depends_on なしの場合
フロントエンド: 「APIに接続できません」エラー
バックエンド: まだ起動中...

✅ depends_on ありの場合
バックエンド: 起動完了！
フロントエンド: APIに正常接続！
```

### 課題2: `frontend/Dockerfile` を作成してください

```dockerfile
# ベースイメージを指定
# ヒント: FROM node:18-alpine

# 作業ディレクトリを設定
# ヒント: WORKDIR /app

# package.jsonをコピーして依存関係をインストール
# ヒント: COPY package*.json ./
# ヒント: RUN npm install

# ソースコードをコピー
# ヒント: COPY . .

# ポート3000を公開
# ヒント: EXPOSE 3000

# 開発サーバーを起動
# ヒント: CMD ["npm", "start"]
```

### 課題3: アプリケーションを起動してください

```bash
docker compose up --build
```

### 課題4: 動作確認してください

ブラウザで以下にアクセス：
- **フロントエンド**: http://localhost:3000
- **バックエンド**: http://localhost:8000

## 🎉 成功の証拠

- フロントエンドでタスク管理画面が表示される
- 初期データとして2つのサンプルタスクが表示される
- 新しいタスクを追加できる（ダミーデータとして保存される）

## ⚠️ Step 2での制限事項

**この段階ではデータベースを使用していないため、以下の制限があります：**

1. **データの永続化なし**
   - 追加したタスクは実際には保存されません
   - ページを更新すると元のダミーデータ（2つのタスク）に戻ります
   - **これは正常な動作です**

2. **成功メッセージの表示**
   - タスク追加時に成功メッセージは表示されませんが、**画面表示は正常に動作**しています
   - フロントエンドとバックエンドの通信は正常に行われています
   - データの永続化と成功メッセージはStep 3で学習します

**確認すべきポイント：**
- ✅ フロントエンド画面が表示される
- ✅ 初期データ（2つのタスク）が表示される
- ✅ タスク追加フォームが動作する（一時的に表示される）
- ✅ フロントエンドとバックエンドが通信できている

## 📚 詳細な説明

詳しい手順は [docs/step2-compose.md](docs/step2-compose.md) を参照してください。

## 🚀 次のステップ

完了したら以下のコマンドで次のステップに進んでください：

```bash
git checkout exercise/step-3
```